env:
  matrix:
  - APP_ENV=test BUNDLER_VERSION=2.1.4
  global:
    secure: dkFwKhLE7IUjuz1Usw0MQ7CMTPDfusTPl50Z7hyOCcQcoH6uqkwFSnG/TqELW5Ot5Sp/64jOpWqnecJK8Cf5/dol1beeboDD9G7LDF7MVcUHwq8LBsDRBO5ckOGVN80inPnVsMyPPHfeNQQj2pUWp4pmnwUmoKC5C3Nq7q56CAerSqPDfdjny3anK8Nn25Jq5/3Zf+P9YMWu9U4EVsvyesgblZBsZwNLwobGbMgYbCCttAIdMxD9xyHb6ZUJYKE5+FfQ7pj3s9b8ozR2OUGsfka5auLMAkjwWEu3ctUulXhoChNjL1tzGrxRfM26mGsOc1jRId4lX52TkaEAvhteac6ZfYNJ6FbmblYbBr4H8liPDCAxQPM5IPLPz/R9qdoMyVSrMwbEWfryk0Px0SpVGs4Gk2TP/VEfnBmf54sEk8QDXHXwgMCRemK3Hbkq9/SycNvc8NXRgmCkZnUKnBe4ZO2GEgPCW7Dl5rtlNHYxGyg5lW+CRAMSC0B7IF0q5ngg1lr5g3kryhk6w4piyOdjP+OOM2tPzjGqh0ivZfVT28VZfx3pL2m9WYCppq7foh5a9fmTPNzE/v44wugh7hDSMybE+lZmZ3hLgOEVIijq29sBIRcCUVgFebEjT6rMpiAwdbk+4tyb4jki0/kKOcNIF+1Ss709kcH3j5IdDcrqVkw=
language: ruby
cache: bundler
rvm:
- 2.6.6
services:
- docker
before_install:
- gem install bundler -v $BUNDLER_VERSION
bundler_args: "--jobs=3 --retry=3"
jobs:
  include:
  - stage: test
    name: RSpec
    before_script:
    - echo $MY_SECRET_ENV
    - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
      > ./cc-test-reporter
    - chmod +x ./cc-test-reporter
    - "./cc-test-reporter before-build"
    - bundle exec devup up
    script:
    - bundle exec rspec
    after_success:
    - "./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT"
  - stage: test
    name: Lint
    script:
    - bundle exec standardrb
